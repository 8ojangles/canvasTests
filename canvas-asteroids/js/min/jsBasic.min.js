function bulletEmmisionFunct(){playerAlive&&(1==firing&&counter%10==0&&makeBullet(1),0==firing&&makeBullet(0))}function makeBullet(e){for(var l=0;e>l;l++){var a={x:p.x,y:p.y,xVel:bulletXVel,yVel:bulletYVel,r:3};bullets.push(a)}}function bulletUpdater(){for(var e=bullets.length-1;e>=0;e--){var l=bullets[e];c.fillStyle="white",c.fillCircle(l.x,l.y,l.r),l.x+=l.xVel,l.y+=l.yVel,(l.x>canvas.width||l.x<0||l.y>canvas.height||l.y<0)&&bullets.shift()}}function draw(){frameRate=60,c.globalCompositeOperation="source-over",c.fillStyle=rgb(0,0,0),c.fillRect(0,0,canvas.width,canvas.height),200>=bgStars?makeStars(200):makeStars(0),starsRenderer(),startGame&&(bulletDeltaX=mouseX-p.x,bulletDeltaY=mouseY-p.y,bulletAngle=Math.atan2(bulletDeltaY,bulletDeltaX),bulletXVel=Math.cos(bulletAngle)*bulletSpeed,bulletYVel=Math.sin(bulletAngle)*bulletSpeed,populateAsteroids&&(10>asteroidsL?(makeAsteroidL(10),populateAsteroids=!1):makeAsteroidL(0)),asteroidLargeUpdater(),asteroidSmallUpdater(),explosionsUpdater(),bulletUpdater(),bulletEmmisionFunct(),playerRender(),playerUpdate(),playerControls()),gameOverAnim(),counter++,debugOutput()}function makeAsteroidL(e){for(var l=0;e>l;l++){var a={x:random(0,canvas.width),y:random(0,canvas.height),xVel:random(-2,2),yVel:random(-2,2),r:50};asteroidsL.push(a)}}function asteroidLargeUpdater(){for(var e=asteroidsL.length-1;e>=0;e--){var l=asteroidsL[e];c.fillStyle=rgb(150,150,255),c.fillCircle(l.x,l.y,l.r),l.x+=l.xVel,l.y+=l.yVel,l.x>canvas.width+l.r&&(l.x=0-l.r),l.x<0-l.r&&l.xVel<0&&(l.x=canvas.width+l.r),l.y>canvas.height+l.r&&(l.y=0-l.r),l.y<0-l.r&&l.yVel<0&&(l.y=canvas.height+l.r);for(var a=bullets.length-1;a>=0;a--){var r=bullets[a],t=dist(r.x,r.y,l.x,l.y),o=r.r+l.r;o>=t&&(colPointX=l.x,colPointY=l.y,score+=100,makeAsteroidS(10),makeExplosions(1),bullets.splice(a,1),asteroidsL.splice(e,1))}}}function makeAsteroidS(e){for(var l=0;e>l;l++){var a={x:colPointX,y:colPointY,xVel:random(-2,2),yVel:random(-2,2),r:10};asteroidsS.push(a)}}function asteroidSmallUpdater(){for(var e=asteroidsS.length-1;e>=0;e--){var l=asteroidsS[e];c.fillStyle=rgb(150,150,255),c.fillCircle(l.x,l.y,l.r),l.x+=l.xVel,l.y+=l.yVel,l.x>canvas.width+l.r&&(l.x=0-l.r),l.x<0-l.r&&l.xVel<0&&(l.x=canvas.width+l.r),l.y>canvas.height+l.r&&(l.y=0-l.r),l.y<0-l.r&&l.yVel<0&&(l.y=canvas.height+l.r);for(var a=bullets.length-1;a>=0;a--){var r=bullets[a],t=dist(r.x,r.y,l.x,l.y),o=r.r+l.r;o>=t&&(colPointX=l.x,colPointY=l.y,makeExplosions(1),score+=200,bullets.splice(a,1),asteroidsS.splice(e,1))}}}function makeExplosions(e){for(var l=0;e>l;l++){var a={x:colPointX,y:colPointY,colR:255,colG:255,colB:255,colA:1,line:20,r:10};explosions.push(a)}}function explosionsUpdater(){for(var e=explosions.length-1;e>=0;e--){var l=explosions[e];c.lineWidth=l.line,c.strokeStyle=rgba(l.colR,l.colG,l.colB,l.colA),c.strokeCircle(l.x,l.y,l.r),c.strokeCircle(l.x,l.y,.25*l.r),l.colG-=10,l.colB-=10,l.colA-=.05,l.r+=25,l.line-=2,l.colA>=1&&explosions.splice(e,1)}}function makeStars(e){for(var l=0;e>l;l++){var a={x:random(0,canvas.width),y:random(0,canvas.height),colR:255,colG:255,colB:255,r:random(.5,1)};bgStars.push(a)}}function starsRenderer(){for(var e=bgStars.length-1;e>=0;e--){var l=bgStars[e];c.fillStyle=rgb(l.colR,l.colG,l.colB),c.fillCircle(l.x,l.y,l.r)}}var canvas=document.getElementById("myCanvas"),c=canvas.getContext("2d");canvas.width=window.innerWidth,canvas.height=window.innerHeight;var counter=0,score=0,startGame=!1,gameOver=!1,populateAsteroids=!0,playerAlive=!0,playerCollision=!1,playerLives=3,gameOverText={colR:255,colG:255,colB:255,colA:1,font:"100pt arial",x:canvas.width/2,y:canvas.height/2,align:"center"},gT=gameOverText,gameOverAnim=function(){gameOver&&(startGame=!1,c.font=gT.font,c.fillStyle=rgba(gT.colR,gT.colG,gT.colB,gT.colA),c.textAlign=gT.align,c.fillText("GAME OVER",gT.x,gT.y),c.font="50pt arial",c.fillText("SCORE: "+score,gT.x,gT.y+120),gT.colA-=.005,counter%240==0&&($(".startButton.off").removeClass("off").addClass("on"),$(".playerControls.off").removeClass("off").addClass("on"),initGame()))},player={x:canvas.width/2,y:canvas.height/2,r:20,colR:150,colG:150,colB:150,xVel:0,yVel:0},firing=!1,colPointX=0,colPointY=0,p=player,playerRender=function(){if(playerAlive){(playerLeftKey||playerRightKey)&&boosterXRender(),(playerUpKey||playerDownKey)&&boosterYRender(),c.fillStyle=rgb(p.colR,p.colG,p.colB),c.fillCircle(p.x,p.y,p.r),c.lineWidth=4;var e=mouseX-p.x,l=mouseY-p.y,a=Math.atan2(l,e);c.strokeStyle=rgb(200,0,0),c.save(),c.translate(p.x,p.y),c.rotate(a),c.beginPath(),c.moveTo(0,0),c.lineTo(20,0),c.stroke(),c.restore()}},boosterXRender=function(){var e=random(50,150);if(c.globalCompositeOperation="lighter",playerLeftKey){var l=c.createLinearGradient(p.x,p.y-10,p.x+e,p.y+10);l.addColorStop(0,"rgba(255,255,255,1)"),l.addColorStop(1,"rgba(0,0,255,0)"),c.fillStyle=l,c.fillRect(p.x,p.y-10,e,20)}if(playerRightKey){var l=c.createLinearGradient(p.x,p.y-10,p.x-e,p.y+10);l.addColorStop(0,"rgba(255,255,255,1)"),l.addColorStop(1,"rgba(0,0,255,0)"),c.fillStyle=l,c.fillRect(p.x,p.y-10,-e,20)}c.globalCompositeOperation="source-over"},boosterYRender=function(){var e=random(50,150);if(c.globalCompositeOperation="lighter",playerUpKey){var l=c.createLinearGradient(p.x-10,p.y,p.x+10,p.y+e);l.addColorStop(0,"rgba(255,255,255,1)"),l.addColorStop(1,"rgba(0,0,255,0)"),c.fillStyle=l,c.fillRect(p.x-10,p.y,20,e)}if(playerDownKey){var l=c.createLinearGradient(p.x-10,p.y,p.x+10,p.y-e);l.addColorStop(0,"rgba(255,255,255,1)"),l.addColorStop(1,"rgba(0,0,255,0)"),c.fillStyle=l,c.fillRect(p.x-10,p.y,20,-e)}c.globalCompositeOperation="source-over"},boundaryWrap=function(){p.x>canvas.width+p.r&&(p.x=0-p.r),p.x<0-p.r&&p.xVel<0&&(p.x=canvas.width),p.y>canvas.height&&(p.y=0-p.r),p.y<0-p.r&&p.yVel<0&&(p.y=canvas.height)},playerUpdate=function(){if(playerAlive&&playerLives>0){boundaryWrap(),p.x+=p.xVel,p.y+=p.yVel;for(var e=asteroidsL.length-1;e>=0;e--){aL=asteroidsL[e];var l=dist(p.x,p.y,aL.x,aL.y),a=p.r+aL.r;a>=l&&(colPointX=aL.x,colPointY=aL.y,p.x=null,p.y=null,thisTime=counter,playerCollision=!0,playerLives-=1,playerAlive=!1,asteroidsL.splice(e,1),makeAsteroidS(10),makeExplosions(1))}for(var e=asteroidsS.length-1;e>=0;e--){aS=asteroidsS[e];var l=dist(p.x,p.y,aS.x,aS.y),a=p.r+aS.r;a>=l&&(colPointX=aS.x,colPointY=aS.y,p.x=null,p.y=null,thisTime=counter,playerCollision=!0,playerLives-=1,playerAlive=!1,asteroidsS.splice(e,1),makeExplosions(1))}}playerCollision&&playerLives>0&&counter-thisTime>=120&&(playerAlive=!0,playerCollision=!1,p.x=canvas.width/2,p.y=canvas.height/2,p.xVel=0,p.yVel=0),0>=playerLives&&(gameOver=!0,startGame=!1)},bullets=[],bulletDeltaX,bulletDeltaY,bulletAngle,bulletXVel,bulletYVel,bulletSpeed=20,asteroidsL=[],asteroidsS=[],explosions=[],bgStars=[],initGame=function(){score=0,startGame=!1,gameOver=!1,populateAsteroids=!0,playerAlive=!0,playerCollision=!1,playerLives=3,p.x=canvas.width/2,p.y=canvas.height/2,p.yVel=0,p.xVel=0,gT.colA=1,asteroidsL.length=0,asteroidsS.length=0,explosions.length=0,bullets.length=0},debugOutput=function(){c.textAlign="center",c.font="20pt arial",c.fillStyle="#ccc",c.fillText("score "+score,canvas.width/2,50),c.fillText("playerLives "+playerLives,200,50)};