function keyFunctionRuntime(){playerUpKey&&p.yVel>-10&&(p.yVel-=.5),!playerUpKey&&p.yVel<0&&(p.yVel+=.5),playerDownKey&&p.yVel<10&&(p.yVel+=.5),!playerDownKey&&p.yVel>0&&(p.yVel-=.5),playerLeftKey&&p.xVel>-10&&(p.xVel-=.5),!playerLeftKey&&p.xVel<0&&(p.xVel+=.5),playerRightKey&&p.xVel<10&&(p.xVel+=.5),!playerRightKey&&p.xVel>0&&(p.xVel-=.5)}function draw(){frameRate=60,c.globalCompositeOperation="source-over",c.fillStyle=rgb(0,0,0),c.fillRect(0,0,canvas.width,canvas.height),playerRender(),playerUpdate(),keyFunctionRuntime(),c.font="20pt arial",c.fillStyle="#ccc",c.fillText("p.hiLite "+p.hiLite,canvas.width-400,100),c.fillText("p.xOffset "+p.xOffset,canvas.width-400,130),c.fillText("p.yOffset "+p.yOffset,canvas.width-400,160),c.fillText("p.x "+p.x,canvas.width-400,190),c.fillText("p.y "+p.y,canvas.width-400,220),c.fillText("mouseX "+mouseX,canvas.width-400,250),c.fillText("mouseY "+mouseY,canvas.width-400,280),c.fillText("p.xVel "+p.xVel,canvas.width-400,310),c.fillText("p.yVel "+p.yVel,canvas.width-400,340)}var canvas=document.getElementById("myCanvas"),c=canvas.getContext("2d");canvas.width=window.innerWidth,canvas.height=window.innerHeight;var player={x:canvas.width/2,y:canvas.height/2,w:100,h:100,colR:150,colG:150,colB:150,xVel:0,yVel:0,hiLite:!1,xOffset:0,yOffset:0,xCurOffset:0,yCurOffset:0,dragged:!1},p=player,playerRender=function(){c.fillStyle=rgb(p.colR,p.colG,p.colB),c.fillRect(p.x,p.y,p.w,p.h)},playerHiLite=function(){mouseX>=p.x&&mouseX<=p.x+p.w?mouseY>=p.y&&mouseY<=p.y+p.h?(p.hiLite=!0,p.colR=p.colG=p.colB=255):p.hiLite=!1:p.hiLite=!1,playerNotHiLite()},playerNotHiLite=function(){0==p.hiLite&&(p.colR>150&&(p.colR-=4),p.colG>150&&(p.colG-=4),p.colB>150&&(p.colB-=4))},dragDropSwitch=function(){1==p.hiLite&&(mouseDown&&(p.dragged=!0,p.xCurOffset=p.xOffset,p.yCurOffset=p.yOffset),mouseDown||(p.dragged=!1,p.xOffset=mouseX-p.x,p.yOffset=mouseY-p.y,p.xVel=xVelStore,p.yVel=yVelStore))},dragDrop=function(){1==p.dragged&&(p.x=mouseX-p.xCurOffset,p.y=mouseY-p.yCurOffset)},boundaryWrap=function(){p.x>canvas.width&&(p.x=0-p.w),p.x<0-p.w&&p.xVel<0&&(p.x=canvas.width),p.y>canvas.height&&(p.y=0-p.h),p.y<0-p.h&&p.yVel<0&&(p.y=canvas.height)},prevX=0,prevY=0,xVelStore=0,yVelStore=0,playerUpdate=function(){prevX=p.x,prevY=p.y,playerHiLite(),dragDropSwitch(),dragDrop(),boundaryWrap(),p.x+=p.xVel,p.y+=p.yVel,xVelStore=p.x-prevX,yVelStore=p.y-prevY},playerUpKey=!1,playerDownKey=!1,playerLeftKey=!1,playerRightKey=!1;$(document).bind("keydown","w",function(){playerUpKey=!0}),$(document).bind("keyup","w",function(){playerUpKey=!1}),$(document).bind("keydown","s",function(){playerDownKey=!0}),$(document).bind("keyup","s",function(){playerDownKey=!1}),$(document).bind("keydown","a",function(){playerLeftKey=!0}),$(document).bind("keyup","a",function(){playerLeftKey=!1}),$(document).bind("keydown","d",function(){playerRightKey=!0}),$(document).bind("keyup","d",function(){playerRightKey=!1});